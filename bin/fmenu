#!/bin/sh

input=$(mktemp -u --suffix .fmenu.input)
output=$(mktemp -u --suffix .fmenu.output)
mkfifo $input
mkfifo $output
chmod 600 $input $output

term=${FMENU_DEFAULT_TERM:-alacritty --class fmenu --title fmenu}
$term -e sh -c "cat $input | \
  fzf --reverse $FMENU_FZF_DEFAULT_OPTS $@ | \
  tee $output" & disown

trap "kill $! 2>/dev/null; rm -f $input $output" EXIT

cat > $input
cat $output
